{"version":3,"sources":["../../src/generators/component/index.js"],"names":["pascalCase","require","chalk","VulcanGenerator","ast","module","exports","initializing","_assertIsVulcan","_assertHasNonZeroPackages","inputProps","_registerArguments","_registerPackageNameOption","_registerModuleNameOption","_registerComponentNameOption","prompting","_canPrompt","firstQuestions","_getPackageNameListQuestion","prompt","then","answers","props","packageName","_filterPackageName","storyBookSetupStatus","_assertPackageHasNonZeroModules","secondQuestions","_getModuleNameListQuestion","_getComponentNameQuestion","_getComponentTypeQuestion","_getIsRegisterComponentQuestion","_packageHasNonZeroModules","Promise","reject","moduleName","componentName","componentType","isRegister","isAddComponentToStoryBook","componentPath","_getComponentPath","isAbsolute","templatePath","_assertModuleIsExists","configuring","_canConfigure","_dispatch","type","status","_commitStore","_canInstall","_getStoryBookSetupStatus","_installStorybook","log","green","spawnCommandSync","_writeComponent","fs","copyTpl","_updateModuleStories","moduleStoriesPath","_getModuleStoriesPath","fileText","read","importStatement","_getComponentFileName","fileWithImportText","addImportStatementAndParse","write","writing","_canWrite","end","_end"],"mappings":"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","file":"index.js","sourcesContent":["const pascalCase = require('pascal-case');\nconst chalk = require('chalk');\nconst VulcanGenerator = require('../../lib/VulcanGenerator');\nconst ast = require('../../lib/ast');\n\nmodule.exports = class extends VulcanGenerator {\n  initializing () {\n    this._assertIsVulcan();\n    this._assertHasNonZeroPackages();\n    this.inputProps = {};\n  }\n\n  _registerArguments () {\n    this._registerPackageNameOption();\n    this._registerModuleNameOption();\n    this._registerComponentNameOption();\n  }\n\n  prompting () {\n    if (!this._canPrompt()) { return false; }\n    const firstQuestions = [\n      // this._getStoryBookSetupQuestion(),\n      this._getPackageNameListQuestion(),\n    ];\n\n    return this.prompt(firstQuestions)\n    .then((answers) => {\n      this.props = {\n        packageName: this._filterPackageName(this.inputProps.packageName || answers.packageName),\n        storyBookSetupStatus: this.inputProps.storyBookSetupStatus || answers.storyBookSetupStatus,\n      };\n      this._assertPackageHasNonZeroModules(this.props.packageName);\n      const secondQuestions = [\n        this._getModuleNameListQuestion(),\n        this._getComponentNameQuestion(),\n        this._getComponentTypeQuestion(),\n        this._getIsRegisterComponentQuestion(),\n        // this._getIsAddComponentToStoryBookQuestion(),\n      ];\n      if (this._packageHasNonZeroModules(this.props.packageName)) {\n        return this.prompt(secondQuestions);\n      }\n      return Promise.reject('noModulesInPackage');\n    })\n    .then((answers) => {\n      this.props = {\n        ...this.props,\n        moduleName: this.inputProps.moduleName || answers.moduleName,\n        componentName: pascalCase(this.inputProps.componentName || answers.componentName),\n        componentType: this.inputProps.componentType || answers.componentType,\n        isRegister: this.inputProps.isRegister || answers.isRegister,\n        isAddComponentToStoryBook: (\n          this.inputProps.isAddComponentToStoryBook ||\n          answers.isAddComponentToStoryBook\n        ),\n      };\n      this.props.componentPath = this._getComponentPath({\n        isAbsolute: true,\n      });\n      this.props.templatePath = this.props.componentType === 'pure' ?\n        this.templatePath('pureFunctionComponent.js') :\n        this.templatePath('classComponent.js');\n      this._assertModuleIsExists(this.props.packageName, this.props.moduleName);\n    }, () => {});\n  }\n\n  configuring () {\n    if (!this._canConfigure()) { return; }\n    if (this.props.storyBookSetupStatus) {\n      this._dispatch({\n        type: 'SET_STORYBOOK_SETUP_STATUS',\n        status: this.props.storyBookSetupStatus,\n      });\n    }\n    this._commitStore();\n    // this._installStorybook();\n  }\n\n  _canInstall () {\n    return super._canInstall() && this._getStoryBookSetupStatus() === 'installing';\n  }\n\n  _installStorybook () {\n    if (!this._canInstall()) { return; }\n    this.log(chalk.green('\\nTaking you to react storybook setup... \\n'));\n    this.spawnCommandSync('getstorybook');\n    this._dispatch({\n      type: 'SET_STORYBOOK_SETUP_STATUS',\n      status: 'installed',\n    });\n    this._commitStore();\n  }\n\n  _writeComponent () {\n    this.fs.copyTpl(\n      this.props.templatePath,\n      this.props.componentPath,\n      this.props\n    );\n  }\n\n  _updateModuleStories () {\n    if (!this.props.isAddComponentToStoryBook) { return; }\n    const moduleStoriesPath = this._getModuleStoriesPath({\n      isAbsolute: true,\n    });\n    const fileText = this.fs.read(moduleStoriesPath);\n    const importStatement = `import ${this.props.componentName} from './${this._getComponentFileName()};'`;\n    const fileWithImportText = ast.addImportStatementAndParse(\n      fileText,\n      importStatement\n    );\n    this.fs.write(\n      moduleStoriesPath,\n      fileWithImportText\n    );\n  }\n\n  writing () {\n    if (!this._canWrite()) { return; }\n    this._writeComponent();\n    // this._updateModuleStories();\n  }\n\n  end () {\n    this._end();\n  }\n};\n"]}